import { useId } from 'react'
import Image, { type ImageProps } from 'next/image'
import clsx from 'clsx'

const shapes = [
  {
    width: 655,
    height: 680,
    path: "M639.59,314.57v-5.93l.07-111.43c0-2.91-1.14-5.52-3.02-7.4L446.82,0l-115.8.07-174.59.11c-2.71,0-5.47,1.02-7.33,2.88L3.07,149.09c-1.87,1.86-2.88,4.62-2.88,7.33l-.11,174.59v.02s-.08,115.8-.08,115.8l189.81,189.81c1.88,1.88,4.49,3.02,7.39,3.02l111.43-.07h5.93l55.38-.08-.04.16h259.33c1.46,0,2.84-.28,4.09-.81.16-.07.31-.14.47-.21.07-.04.14-.07.21-.11.19-.09.37-.19.55-.3.19-.1.37-.21.54-.33.09-.06.18-.13.27-.19.91-.65,1.7-1.44,2.35-2.35.07-.08.13-.18.19-.27.12-.19.23-.36.33-.54.11-.18.21-.36.3-.55.04-.07.07-.14.11-.21.07-.16.15-.31.21-.47.52-1.25.81-2.63.81-4.09v-259.33l-.16.04.09-55.38ZM550.94,565.88l-95.07-.03c-13.31.03-20.02-16.09-10.6-25.51l95.07-95.07c9.43-9.42,25.55-2.71,25.52,10.59l.03,95.07c0,8.25-6.69,14.95-14.95,14.95Z",
  },
  {
    width: 719,
    height: 680,
    path: "M639.59,331.03v-.02s-.12-174.59-.12-174.59c0-2.71-1.01-5.47-2.88-7.33L490.56,3.06c-1.86-1.86-4.62-2.88-7.33-2.88l-174.59-.11-115.8-.07L3.02,189.81c-1.88,1.88-3.02,4.49-3.02,7.4l.07,111.43v5.93l.09,55.38-.16-.04v259.33c0,1.46.29,2.84.81,4.09.06.16.14.31.21.47.04.07.07.14.11.21.09.19.19.37.3.55.1.18.21.35.33.54.06.09.12.19.19.27.65.91,1.44,1.7,2.35,2.35.09.06.18.13.27.19.17.12.35.23.54.33.18.11.36.21.55.3.07.04.14.07.21.11.16.07.31.14.47.21,1.25.53,2.63.81,4.09.81h259.33l-.04-.16,55.38.08h5.93l111.43.07c2.9,0,5.51-1.14,7.39-3.02l189.81-189.81-.07-115.8ZM183.79,565.85l-95.07.03c-8.26,0-14.95-6.7-14.95-14.95l.03-95.07c-.03-13.3,16.09-20.01,25.52-10.59l95.07,95.07c9.42,9.42,2.71,25.54-10.6,25.51Z",
  },
  {
    width: 719,
    height: 680,
    path: "M639.59,314.57v-5.93l.07-111.43c0-2.91-1.14-5.52-3.02-7.4L446.82,0l-115.8.07-174.59.11c-2.71,0-5.47,1.02-7.33,2.88L3.07,149.09c-1.87,1.86-2.88,4.62-2.88,7.33l-.11,174.59v.02s-.08,115.8-.08,115.8l189.81,189.81c1.88,1.88,4.49,3.02,7.39,3.02l111.43-.07h5.93l55.38-.08-.04.16h259.33c1.46,0,2.84-.28,4.09-.81.16-.07.31-.14.47-.21.07-.04.14-.07.21-.11.19-.09.37-.19.55-.3.19-.1.37-.21.54-.33.09-.06.18-.13.27-.19.91-.65,1.7-1.44,2.35-2.35.07-.08.13-.18.19-.27.12-.19.23-.36.33-.54.11-.18.21-.36.3-.55.04-.07.07-.14.11-.21.07-.16.15-.31.21-.47.52-1.25.81-2.63.81-4.09v-259.33l-.16.04.09-55.38ZM550.94,565.88l-95.07-.03c-13.31.03-20.02-16.09-10.6-25.51l95.07-95.07c9.43-9.42,25.55-2.71,25.52,10.59l.03,95.07c0,8.25-6.69,14.95-14.95,14.95Z",
  },
]




type ImagePropsWithOptionalAlt = Omit<ImageProps, 'alt'> & { alt?: string }

export function StylizedImage({
  shape = 0,
  className,
  ...props
}: ImagePropsWithOptionalAlt & { shape?: 0 | 1 | 2 }) {
  let id = useId()
  let { width, height, path } = shapes[shape]

  return (
    <div
      className={clsx(
        className,
        'relative flex aspect-[719/680] w-full grayscale',
      )}
    >
      <svg viewBox={`0 0 ${width} ${height}`} fill="none" className="h-full">
        <g clipPath={`url(#${id}-clip)`} className="group">
          <g className="origin-center scale-100 transition duration-500 motion-safe:group-hover:scale-105">
            <foreignObject width={width} height={height}>
              <Image
                alt=""
                className="w-full bg-neutral-100 object-cover"
                style={{ aspectRatio: `${width} / ${height}` }}
                {...props}
              />
            </foreignObject>
          </g>
          <use
            href={`#${id}-shape`}
            strokeWidth="2"
            className="stroke-neutral-950/10"
          />
        </g>
        <defs>
          <clipPath id={`${id}-clip`}>
            <path
              id={`${id}-shape`}
              d={path}
              fillRule="evenodd"
              clipRule="evenodd"
            />
          </clipPath>
        </defs>
      </svg>
    </div>
  )
}
